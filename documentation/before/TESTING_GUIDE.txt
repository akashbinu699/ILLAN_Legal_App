================================================================================
                    LEGALEASE CAF MANAGER - TESTING GUIDE
                    Step-by-Step Instructions for First-Time Users
================================================================================

This guide will walk you through testing the LegalEase CAF Manager application
from start to finish, assuming you've never used it before.

================================================================================
                        PREREQUISITES & SETUP
================================================================================

STEP 1: Install Node.js
------------------------
What you need: Node.js installed on your computer

How to check if you have it:
1. Open Terminal (Mac) or Command Prompt (Windows)
2. Type: node --version
3. If you see a version number (like v18.0.0 or higher), you're good!
4. If you see an error, download Node.js from: https://nodejs.org/

Why you need it: The application runs on Node.js, which is a JavaScript runtime.

STEP 2: Get a Google Gemini API Key
-------------------------------------
What you need: A Google Gemini API key

How to get one:
1. Go to: https://makersuite.google.com/app/apikey
   (or search "Google Gemini API key" in Google)
2. Sign in with your Google account
3. Click "Create API Key" or "Get API Key"
4. Copy the API key (it looks like: AIzaSy...)

IMPORTANT: Keep this key secret! Don't share it publicly.

Why you need it: The application uses Google's AI to analyze cases and generate
documents. The API key authenticates your requests.

STEP 3: Set Up the Project
---------------------------
1. Open Terminal/Command Prompt
2. Navigate to the project folder:
   cd "/Users/artemprokhorov/Desktop/Jobs : Work/Nanny AI/Ilan_Legal_App"
   
   (Replace with your actual path if different)

3. Install dependencies:
   npm install
   
   This downloads all required packages (React, TypeScript, etc.)
   Wait for it to finish (may take 1-2 minutes)

4. Create environment file:
   Create a file named ".env.local" in the project root folder
   
   Add this line (replace YOUR_API_KEY with your actual key):
   GEMINI_API_KEY=YOUR_API_KEY
   
   Example:
   GEMINI_API_KEY=AIzaSyAbc123Xyz789...

Why this matters: The application needs the API key to access Google's AI service.

================================================================================
                        STARTING THE APPLICATION
================================================================================

STEP 4: Start the Development Server
-------------------------------------
1. Make sure you're in the project folder in Terminal/Command Prompt

2. Run this command:
   npm run dev

3. You should see output like:
   VITE v6.x.x  ready in xxx ms
   ➜  Local:   http://localhost:3000/
   ➜  Network: http://192.168.x.x:3000/

4. Open your web browser (Chrome, Firefox, Safari, etc.)

5. Go to: http://localhost:3000

What you should see:
- A navigation bar at the top with "LegalEase CAF Manager"
- Two buttons: "Vue Client" and "Espace Avocat (0)"
- A form below with "Contestez votre décision CAF" heading

If you see an error:
- Check that the API key is correct in .env.local
- Make sure you saved the .env.local file
- Restart the server (Ctrl+C to stop, then npm run dev again)

================================================================================
                    TESTING THE CLIENT VIEW (FORM)
================================================================================

STEP 5: Test the Client Submission Form
----------------------------------------
This simulates what a client would do when submitting their case.

5.1 Fill Out Contact Information
---------------------------------
1. In the "1. Mes coordonnées" section:
   - Email field: Enter a test email (e.g., "test@example.com")
   - Phone field: Enter a test phone (e.g., "0612345678")

What to expect: The fields should accept your input.

5.2 Upload Test Documents
-------------------------
You need at least one file to test. Here are options:

Option A: Use a real CAF document (if you have one)
- Click the file upload area or drag-and-drop a PDF/image
- The file should appear in a list below

Option B: Create a test file
1. Create any PDF or image file on your computer
2. It can be empty or contain anything (for testing purposes)
3. Upload it using the form

What to expect:
- The upload area shows "X fichier(s) sélectionné(s)"
- Your file name appears in a list
- You can click the X button to remove files

5.3 Add Case Description (Optional)
------------------------------------
In the "Description de votre affaire" textarea, type something like:
"La CAF me réclame un trop-perçu de RSA. Je conteste cette décision car
j'ai bien déclaré tous mes revenus."

This helps the AI understand the case better.

5.4 Check Consent Boxes
------------------------
Two checkboxes must be checked:
1. "Je confirme que ma demande concerne le RSA, la Prime d'activité, ou
   l'Aide au logement..."
2. "Je consent à l'utilisation de mes données personnelles..."

Check both boxes.

5.5 Submit the Form
------------------
1. Click the button: "Connaître mes chances de succès"

What should happen:
- If validation passes: You see a success screen with a green checkmark
- If validation fails: Red error messages appear below the fields

Common validation errors:
- Missing email → "L'email est requis"
- Missing phone → "Le téléphone est requis"
- No files → "Au moins un document de la CAF est requis"
- Missing consent → Form won't submit

STEP 6: Observe Background AI Processing
----------------------------------------
After submitting, the form processes in the background. Here's what happens:

1. Case is created immediately (you see the success screen)

2. In the background (you won't see this directly, but it's happening):
   - AI analyzes your description and files
   - Determines the legal stage (CONTROL, RAPO, or LITIGATION)
   - Identifies which benefits/prestations are involved
   - Generates email and appeal drafts

3. To see the results:
   - Click "Accéder à l'Espace Avocat" button on the success screen
   - This takes you to the lawyer view

================================================================================
                    TESTING THE LAWYER VIEW (DASHBOARD)
================================================================================

STEP 7: Navigate to Lawyer Dashboard
-------------------------------------
1. Click "Espace Avocat" button in the navigation bar
   OR
   Click "Accéder à l'Espace Avocat" from the success screen

What you should see:
- Left sidebar: List of cases (you should see your test case)
- Right side: Either empty (if no case selected) or case details

STEP 8: Explore the Case List
-----------------------------
In the left sidebar, you'll see your case with:
- Case ID: CAS-2025-001 (or similar)
- Time submitted
- Email address
- Stage badge (CONTROL, RAPO, or LITIGATION)
- Prestation tags (RSA, APL, etc.)
- Description preview

Click on the case to select it.

STEP 9: Review Case Details Tab
--------------------------------
1. The case detail view opens on the right
2. Click the "Détails" tab (if not already selected)

What you'll see:
- Case header with ID, email, phone
- Prestation tags (showing which benefits were detected)
- Client description
- File buttons (click to view uploaded files)

3. Click a file button to open the file in a new window

STEP 10: Review the Stage Selector
-----------------------------------
Above the tabs, you'll see three buttons:
- "Contrôle / Contradictoire" (CONTROL)
- "RAPO (Recours Amiable)" (RAPO)
- "Contentieux (Tribunal)" (LITIGATION)

One should be highlighted in red (the detected stage).

Try clicking a different stage:
- The stage changes immediately
- You'll see regeneration messages in the draft areas
- After a few seconds, new drafts appear (if AI processing completes)

STEP 11: Review Email Draft
----------------------------
1. Click the "Projet d'Email" tab

What you'll see:
- A prompt editor at the top (can be collapsed)
- Toolbar with "Régénérer" and "Exporter" buttons
- A large A4-sized text editor with the AI-generated email

The email should:
- Be addressed to the client
- Explain the situation
- Provide next steps
- Be written in French (as the app is for French legal cases)

2. Try editing the email:
   - Click in the text area
   - Make some changes
   - Click outside the text area (blur event)
   - Your changes are automatically saved

3. Try editing the prompt:
   - Expand the prompt editor if collapsed
   - Modify the instructions
   - Click "Régénérer le brouillon"
   - Wait for regeneration (you'll see a spinner)
   - New email appears based on your custom prompt

4. Try exporting:
   - Click "Exporter" button
   - A file downloads: "brouillon_email_CAS-2025-001.eml"
   - This is an Outlook email file (double-click to open in Outlook)

STEP 12: Review Appeal Draft
-----------------------------
1. Click the "Projet de Recours" tab

What you'll see:
- Similar layout to email tab
- Prompt editor for appeal generation
- A4-sized editor with the AI-generated appeal document

The appeal should:
- Be a formal legal document
- Include proper structure (OBJET, FAITS, DISCUSSION, etc.)
- Reference legal articles
- Be written in formal French legal language

2. Try the same operations as with email:
   - Edit the content
   - Edit the prompt and regenerate
   - Export as Word document (.doc file)

STEP 13: Test Stage Change Workflow
------------------------------------
This tests the complete regeneration workflow:

1. Note the current stage (highlighted in red)

2. Click a different stage button (e.g., if RAPO, click LITIGATION)

What happens:
- Stage changes immediately
- Drafts show: "♻️ Changement de phase... Régénération..."
- After processing, new drafts appear with content appropriate for that stage

Why this matters: Different legal stages require different document types and
formats. The AI adapts its output accordingly.

================================================================================
                    TESTING EDGE CASES & ERROR HANDLING
================================================================================

STEP 14: Test Form Validation
------------------------------
Go back to the Client View and test validation:

14.1 Test Missing Email
-----------------------
1. Clear the email field
2. Fill everything else
3. Try to submit
Expected: Red error "L'email est requis"

14.2 Test Missing Phone
-----------------------
1. Fill email but clear phone
2. Try to submit
Expected: Red error "Le téléphone est requis"

14.3 Test No Files
------------------
1. Remove all files
2. Try to submit
Expected: Red error "Au moins un document de la CAF est requis"

14.4 Test Missing Consent
------------------------
1. Uncheck one or both consent boxes
2. Try to submit
Expected: Button is disabled (grayed out)

STEP 15: Test Multiple Cases
-----------------------------
1. Submit another case with different information
2. Go to Lawyer View
3. You should see both cases in the sidebar
4. Case IDs should be sequential: CAS-2025-001, CAS-2025-002, etc.

STEP 16: Test File Viewing
---------------------------
1. In Lawyer View, select a case
2. Click a file button in the header
3. File should open in a new browser window/tab
4. For PDFs: Should display the PDF
5. For images: Should display the image

STEP 17: Test Export Functionality
-----------------------------------
17.1 Export Email
----------------
1. Go to Email tab
2. Click "Exporter"
3. Check your Downloads folder
4. File should be: "brouillon_email_CAS-XXXX-XXX.eml"
5. Double-click to open (should open in email client if configured)

17.2 Export Appeal
------------------
1. Go to Appeal tab
2. Click "Exporter"
3. Check your Downloads folder
4. File should be: "recours_caf_CAS-XXXX-XXX.doc"
5. Double-click to open (should open in Word or compatible app)

================================================================================
                    TESTING AI FEATURES
================================================================================

STEP 18: Test AI Stage Detection
----------------------------------
The AI should automatically detect the legal stage. To verify:

1. Submit a case with description mentioning:
   - "notification d'indu" or "trop-perçu" → Should detect RAPO
   - "procédure contradictoire" → Should detect CONTROL
   - "tribunal administratif" or "rejet" → Should detect LITIGATION

2. Check the stage badge in the case list
3. Check the stage selector in case details

Note: Detection may not be perfect, but it should be reasonable based on
the description and documents provided.

STEP 19: Test AI Prestation Detection
--------------------------------------
The AI identifies which benefits are involved:

1. In case details, look at the prestation tags
2. They should show benefits like:
   - RSA (Revenu de solidarité active)
   - APL (Aide personnalisée au logement)
   - Prime d'activité
   - etc.

3. Tags are color-coded:
   - Gray: Accepted (firm handles this)
   - Red: Not accepted (firm doesn't handle this)

STEP 20: Test Prompt Customization
------------------------------------
1. Go to Email or Appeal tab
2. Expand the prompt editor
3. Modify the prompt (add instructions like "Make it more formal" or
   "Include more legal references")
4. Click "Régénérer le brouillon"
5. Observe how the output changes based on your custom prompt

This demonstrates the flexibility of the AI system.

STEP 21: Test AI Error Handling
---------------------------------
To test error handling (if API key is invalid or network fails):

1. Temporarily break the API key in .env.local (add "X" at the end)
2. Restart the server
3. Try submitting a case
4. Check browser console (F12 → Console tab) for errors
5. The app should handle errors gracefully (may show default values)

Restore the correct API key after testing.

================================================================================
                    TESTING USER INTERFACE FEATURES
================================================================================

STEP 22: Test Navigation
-------------------------
1. Switch between "Vue Client" and "Espace Avocat" using navigation buttons
2. The view should switch smoothly
3. Case count in "Espace Avocat" button should update (e.g., "Espace Avocat (1)")

STEP 23: Test Responsive Design
--------------------------------
1. Resize your browser window
2. The layout should adapt:
   - On wide screens: Sidebar and main content side-by-side
   - On narrow screens: Layout may stack or adjust

STEP 24: Test Visual Feedback
-------------------------------
1. Hover over buttons - they should change color
2. Click buttons - they should show active states
3. During AI processing - spinners should appear
4. Selected case in sidebar - should have blue background and red left border

================================================================================
                    VERIFYING DATA PERSISTENCE
================================================================================

STEP 25: Test State Persistence During Session
------------------------------------------------
1. Create a case
2. Edit the email draft
3. Switch to another case
4. Switch back to the first case
5. Your edits should still be there

Note: Data is stored in browser memory (React state). Refreshing the page
will lose all data. This is expected behavior for the initial version.

STEP 26: Test Case Updates
---------------------------
1. Select a case
2. Make edits to email or appeal
3. Change the stage
4. All changes should persist as long as you don't refresh the page

================================================================================
                    TROUBLESHOOTING COMMON ISSUES
================================================================================

ISSUE: "API Key is missing" error
----------------------------------
Solution:
1. Check that .env.local file exists in project root
2. Verify it contains: GEMINI_API_KEY=your_key_here
3. Make sure there are no spaces around the =
4. Restart the development server

ISSUE: "Cannot find module" errors
-----------------------------------
Solution:
1. Run: npm install
2. Make sure you're in the correct project directory
3. Check that node_modules folder exists

ISSUE: Port 3000 already in use
---------------------------------
Solution:
1. Stop other applications using port 3000
2. Or change the port in vite.config.ts (server.port)

ISSUE: AI not generating content
---------------------------------
Solution:
1. Check browser console (F12) for errors
2. Verify API key is valid and has quota
3. Check network tab for failed API requests
4. Try regenerating the draft

ISSUE: Files not uploading
---------------------------
Solution:
1. Check file size (very large files may cause issues)
2. Verify file type is supported (PDF, images)
3. Try a different file
4. Check browser console for errors

ISSUE: Exported files won't open
---------------------------------
Solution:
1. For .eml files: Use Outlook or compatible email client
2. For .doc files: Use Microsoft Word or compatible app
3. Try opening with a text editor to verify content exists

================================================================================
                    TESTING CHECKLIST
================================================================================

Use this checklist to ensure you've tested all major features:

CLIENT VIEW:
[ ] Form validation (email, phone, files, consent)
[ ] File upload (drag-and-drop and file picker)
[ ] Multiple file upload
[ ] File removal
[ ] Form submission
[ ] Success screen display

LAWYER VIEW:
[ ] Case list display
[ ] Case selection
[ ] Case details tab
[ ] Email draft tab
[ ] Appeal draft tab
[ ] Stage selector
[ ] File viewing

EDITING FEATURES:
[ ] Email draft editing
[ ] Appeal draft editing
[ ] Auto-save on blur
[ ] Prompt editing
[ ] Draft regeneration

AI FEATURES:
[ ] Stage detection
[ ] Prestation detection
[ ] Email generation
[ ] Appeal generation
[ ] Stage change regeneration

EXPORT FEATURES:
[ ] Email export (.eml)
[ ] Appeal export (.doc)
[ ] File naming (includes case ID)

NAVIGATION:
[ ] View switching
[ ] Case count updates
[ ] Navigation persistence

ERROR HANDLING:
[ ] Validation errors display
[ ] API errors handled gracefully
[ ] Missing data handled

================================================================================
                    UNDERSTANDING WHAT YOU'RE TESTING
================================================================================

WHAT IS THIS APPLICATION?
------------------------
This is a legal case management tool that helps lawyers handle administrative
appeals against the CAF (French Family Allowance Fund). It uses AI to:

1. Analyze client cases and documents
2. Determine the legal stage of the case
3. Generate professional email drafts to clients
4. Generate formal appeal documents

WHY TEST IT?
------------
Testing ensures:
- The application works as intended
- AI generates appropriate content
- User interface is intuitive
- Data flows correctly
- Errors are handled properly

WHAT TO LOOK FOR WHEN TESTING
-------------------------------
1. Functionality: Does everything work?
2. Accuracy: Does AI generate appropriate content?
3. Usability: Is it easy to use?
4. Performance: Is it fast enough?
5. Error handling: Does it fail gracefully?

WHAT TO EXPECT
--------------
- AI processing takes 10-30 seconds per draft
- Some AI outputs may need manual refinement
- The application is a prototype/demo (data doesn't persist on refresh)
- All processing happens in your browser (no server)

================================================================================
                    NEXT STEPS AFTER TESTING
================================================================================

After completing testing:

1. Document any bugs or issues you find
2. Note any features that don't work as expected
3. Provide feedback on user experience
4. Suggest improvements if you have ideas

If you encounter issues:
- Check the browser console (F12 → Console tab)
- Check the Terminal/Command Prompt for server errors
- Review the error messages carefully
- Refer to the troubleshooting section above

================================================================================
                            END OF TESTING GUIDE
================================================================================

Happy testing! If you have questions or encounter issues not covered here,
refer to the main documentation file: Initial_app_documentation.txt

